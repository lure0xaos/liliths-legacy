<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<dialogueNodes>

	<!-- Default place type dialogues which should never be seen (as the player can never travel freely through the dungeon): -->
	
    <!-- Place type id: innoxia_fields_elis_yui_dungeon_stairs -->
	<scene id="stairs">
		<content folderPath="txt/places/fields/elis/yui_dungeon">STAIRS</content>
		<secondsPassed><![CDATA[15]]></secondsPassed>
		<continuesDialogue>false</continuesDialogue>
		<travelDisabled>false</travelDisabled>
		<responses>
			<response>
				<responseTabIndex><![CDATA[0]]></responseTabIndex>
				<index><![CDATA[1]]></index>
				<responseTitle><![CDATA[Leave]]></responseTitle>
				<responseTooltip><![CDATA[Exit the dungeon and head back out into Elis.]]></responseTooltip>
				<nextDialogue defaultPlaceType="innoxia_fields_elis_town_tower"/>
				<secondsPassed minutes="true"><![CDATA[1]]></secondsPassed>
				<effects><![CDATA[
					[#pc.setLocation(WORLD_TYPE_innoxia_fields_elis_town, PLACE_TYPE_innoxia_fields_elis_town_tower)]
					[#game.appendToTextStartStringBuilder(game.parseFromFile('txt/places/fields/elis/yui_dungeon', 'STAIRS_LEAVE'))]
				]]></effects>
			</response>
		</responses>
	</scene>
	
    <!-- Place type id: innoxia_fields_elis_yui_dungeon_toys -->
	<scene id="toys">
		<content folderPath="txt/places/fields/elis/yui_dungeon">TOYS</content>
		<secondsPassed><![CDATA[15]]></secondsPassed>
		<continuesDialogue>false</continuesDialogue>
		<travelDisabled>false</travelDisabled>
		<responses/>
	</scene>

    <!-- Place type id: innoxia_fields_elis_yui_dungeon_bondage -->
	<scene id="bondage">
		<content folderPath="txt/places/fields/elis/yui_dungeon">BONDAGE</content> <!-- 007 -->
		<secondsPassed><![CDATA[15]]></secondsPassed>
		<continuesDialogue>false</continuesDialogue>
		<travelDisabled>false</travelDisabled>
		<responses/>
	</scene>
	
	
	<!-- Main content scenes: -->
	
    <!-- Exterior scene starts when player waits for Yui to appear -->
	<scene id="meeting">
		<preParsingEffects><![CDATA[
			[#yui.setLocation(pc)]
		]]></preParsingEffects>
		<content folderPath="txt/places/fields/elis/yui_dungeon">MEETING</content>
		<secondsPassed minutes="true"><![CDATA[10]]></secondsPassed>
		<continuesDialogue>false</continuesDialogue>
		<travelDisabled>true</travelDisabled>
		<responses>
			<response>
				<responseTabIndex><![CDATA[0]]></responseTabIndex>
				<index><![CDATA[1]]></index>
				<colour><![CDATA[GENERIC_SEX]]></colour>
				<responseTitle><![CDATA[Submit]]></responseTitle>
				<responseTooltip><![CDATA[
					Submit to Yui and allow her to take you down into her dungeon for a night of submissive, masochistic sex...
					<br/>[style.italicsSex(This will involve submissive, masochistic sex with numerous strangers!)]
				]]></responseTooltip>
				<nextDialogue><![CDATA[innoxia_places_fields_elis_yui_dungeon_session_1_start]]></nextDialogue>
			</response>
			<response>
				<responseTabIndex><![CDATA[0]]></responseTabIndex>
				<index><![CDATA[2]]></index>
				<responseTitle><![CDATA[Refuse]]></responseTitle>
				<responseTooltip><![CDATA[Tell Yui that you're not interested in her offer.]]></responseTooltip>
				<nextDialogue><![CDATA[innoxia_places_fields_elis_yui_dungeon_session_1_refused]]></nextDialogue>
			</response>
		</responses>
	</scene>
	
	<scene id="session_1_refused">
		<preParsingEffects><![CDATA[
			[#yui.setLocation(WORLD_TYPE_EMPTY, PLACE_TYPE_GENERIC_HOLDING_CELL)]
			[#flags.setFlag(FLAG_innoxia_yui_dungeon_refused, true)]
			[#flags.setFlag(FLAG_innoxia_yui_dungeon_unavailable_today, true)]
		]]></preParsingEffects>
		<content folderPath="txt/places/fields/elis/yui_dungeon">MEETING_REFUSE</content>
		<secondsPassed minutes="true"><![CDATA[5]]></secondsPassed>
		<continuesDialogue>false</continuesDialogue>
		<travelDisabled>true</travelDisabled>
		<responses>
			<response>
				<responseTabIndex><![CDATA[0]]></responseTabIndex>
				<index><![CDATA[1]]></index>
				<responseTitle><![CDATA[Continue]]></responseTitle>
				<responseTooltip><![CDATA[Continue on your way through Elis...]]></responseTooltip>
				<nextDialogue defaultPlaceType="innoxia_fields_elis_town_tower_yui"/>
				<secondsPassed minutes="true"><![CDATA[2]]></secondsPassed>
			</response>
		</responses>
	</scene>
	
	<scene id="session_1_start">
		<preParsingEffects><![CDATA[
			[#pc.setLocation(WORLD_TYPE_innoxia_fields_elis_yui_dungeon, PLACE_TYPE_innoxia_fields_elis_yui_dungeon_bondage)]
			[#yui.setLocation(pc)]
		]]></preParsingEffects>
		<content folderPath="txt/places/fields/elis/yui_dungeon">SESSION_1_START</content>
		<secondsPassed minutes="true"><![CDATA[5]]></secondsPassed>
		<continuesDialogue>false</continuesDialogue>
		<travelDisabled>true</travelDisabled>
		<responses>
			<response>
				<responseTabIndex><![CDATA[0]]></responseTabIndex>
				<index><![CDATA[1]]></index>
				<responseTitle><![CDATA[Bondage]]></responseTitle>
				<responseTooltip><![CDATA[Allow Mistress Yui to dress you...]]></responseTooltip>
				<nextDialogue><![CDATA[innoxia_places_fields_elis_yui_dungeon_session_1_dressed]]></nextDialogue>
			</response>
		</responses>
	</scene>
	
	<scene id="session_1_dressed">
		<preParsingEffects><![CDATA[
			[#yui.equipGearBondageBasement(pc, 1)]
			[#pc.incrementHealth(-60)]
		]]></preParsingEffects>
		<content folderPath="txt/places/fields/elis/yui_dungeon">SESSION_1_DRESSED</content>
		<secondsPassed minutes="true"><![CDATA[5]]></secondsPassed>
		<continuesDialogue>true</continuesDialogue>
		<travelDisabled>true</travelDisabled>
		<responses>
			<response>
				<responseTabIndex><![CDATA[0]]></responseTabIndex>
				<index><![CDATA[1]]></index>
				<responseTitle><![CDATA[Prepared]]></responseTitle>
				<responseTooltip><![CDATA[Securely tied to the bondage bench, there's nothing you can do but submit to Yui and allow her to 'prepare' you...]]></responseTooltip>
				<nextDialogue><![CDATA[innoxia_places_fields_elis_yui_dungeon_session_1_prepared]]></nextDialogue>
			</response>
		</responses>
	</scene>
	
	<scene id="session_1_prepared">
		<preParsingEffects><![CDATA[
			[#yui.setLocation(WORLD_TYPE_EMPTY, PLACE_TYPE_GENERIC_HOLDING_CELL)]
			[#game.appendToTextEndStringBuilder(itemGen.generateItem('FETISH_UNREFINED').applyEffect(yui, pc))]
			[#game.appendToTextEndStringBuilder(itemGen.generateItem('innoxia_pills_lubrication').applyEffect(yui, pc))]
			[#game.appendToTextEndStringBuilder(itemGen.generateItem('FETISH_UNREFINED').applyEffect(yui, pc))]
		]]></preParsingEffects>
		<content folderPath="txt/places/fields/elis/yui_dungeon">SESSION_1_PREPARED</content>
		<secondsPassed minutes="true"><![CDATA[5]]></secondsPassed>
		<continuesDialogue>true</continuesDialogue>
		<travelDisabled>true</travelDisabled>
		<responses>
			<response>
				<responseTabIndex><![CDATA[0]]></responseTabIndex>
				<index><![CDATA[1]]></index>
				<responseTitle><![CDATA[Wait]]></responseTitle>
				<responseTooltip><![CDATA[Madly aroused and desperate to be fucked, you squirm about as you wait for Yui's client to arrive...]]></responseTooltip>
				<nextDialogue><![CDATA[innoxia_places_fields_elis_yui_dungeon_session_1_client]]></nextDialogue>
			</response>
		</responses>
	</scene>
	
	<scene id="session_1_client">
		<preParsingEffects><![CDATA[
			[#yui.spawnBasementClient()]
			[#yui.applyClientIntro(client)]
		]]></preParsingEffects>
		<content folderPath="txt/places/fields/elis/yui_dungeon">SESSION_1_CLIENT</content>
		<secondsPassed minutes="true"><![CDATA[5]]></secondsPassed>
		<continuesDialogue>false</continuesDialogue>
		<travelDisabled>true</travelDisabled>
		<responses>
			<!-- 'Master' client: -->
			<response>
				<availabilityConditional><![CDATA[[#!client.hasFetish(FETISH_VOYEURIST) && !client.hasFetish(FETISH_IMPREGNATION)]]]></availabilityConditional>
				<responseTabIndex><![CDATA[0]]></responseTabIndex>
				<index><![CDATA[1]]></index>
				<responseTitle><![CDATA[Punished]]></responseTitle>
				<responseTooltip><![CDATA[This dominant client takes great pleasure in punishing you...]]></responseTooltip>
				<nextDialogue><![CDATA[innoxia_places_fields_elis_yui_dungeon_session_1_client_start]]></nextDialogue>
			</response>
			<!-- 'Teaser' client: -->
			<response>
				<availabilityConditional><![CDATA[[#client.hasFetish(FETISH_VOYEURIST)]]]></availabilityConditional>
				<responseTabIndex><![CDATA[0]]></responseTabIndex>
				<index><![CDATA[1]]></index>
				<responseTitle><![CDATA[Teased]]></responseTitle>
				<responseTooltip><![CDATA[This client takes great pleasure in teasing you...]]></responseTooltip>
				<nextDialogue><![CDATA[innoxia_places_fields_elis_yui_dungeon_session_1_client_start]]></nextDialogue>
			</response>
			<!-- 'Breeder' client: -->
			<response>
				<availabilityConditional><![CDATA[[#client.hasFetish(FETISH_IMPREGNATION)]]]></availabilityConditional>
				<responseTabIndex><![CDATA[0]]></responseTabIndex>
				<index><![CDATA[1]]></index>
				<responseTitle><![CDATA[Fertilised]]></responseTitle>
				<responseTooltip><![CDATA[This client seems intent on getting you pregnant...]]></responseTooltip>
				<nextDialogue><![CDATA[innoxia_places_fields_elis_yui_dungeon_session_1_client_start]]></nextDialogue>
			</response>
		</responses>
	</scene>
	
	<scene id="session_1_client_start">
		<preParsingEffects><![CDATA[
			#IF(client.hasFetish(FETISH_IMPREGNATION))
				[#client.removeExtraBlockedPartsByInventorySlot(IS_PENIS)]
				[#yui.applyCollar(pc, client, true)]
				[#game.appendToTextEndStringBuilder(itemGen.generateItem('innoxia_pills_fertility').applyEffect(client, pc))]
				[#game.appendToTextEndStringBuilder(itemGen.generateItem('innoxia_pills_fertility').applyEffect(client, client))]
			#ELSE
				#IF(game.isAnalContentEnabled() && !client.hasFetish(FETISH_VOYEURIST))
					[#yui.applyAnalBeads(pc, client)]
				#ENDIF
			#ENDIF
		]]></preParsingEffects>
		<content folderPath="txt/places/fields/elis/yui_dungeon">SESSION_1_CLIENT_START</content>
		<secondsPassed minutes="true"><![CDATA[20]]></secondsPassed>
		<continuesDialogue>true</continuesDialogue>
		<travelDisabled>true</travelDisabled>
		<responses>
			<response>
				<responseTabIndex><![CDATA[0]]></responseTabIndex>
				<index><![CDATA[1]]></index>
				<responseTitle><![CDATA[
					#IF(client.hasFetish(FETISH_IMPREGNATION))
						Bred
					#ELSE
						Fucked
					#ENDIF
				]]></responseTitle>
				<responseTooltip><![CDATA[
					#IF(client.hasFetish(FETISH_IMPREGNATION))
						Completely at the mercy of your anonymous [client.Mistress], you're to be made the mother of [client.her] children...
					#ELSE
						Completely at the mercy of your anonymous [client.Mistress], you prepare to get fucked by [client.herHim]...
					#ENDIF
				]]></responseTooltip>
				<nextDialogue/>
				<effects><![CDATA[
					[#client.setExtraBlockedParts(null)]
				]]></effects>
				<sexVariablesWithManager enabled="true">
					<id><![CDATA[innoxia_elis_yui_dungeon_client]]></id>
					<startingPosition><![CDATA[OVER_DESK]]></startingPosition>
					<dominants>
						<character>
							<id>client</id>
							<slot><![CDATA[
								#IF(client.hasFetish(FETISH_IMPREGNATION))
									OVER_DESK_BETWEEN_LEGS
								#ELSE
									OVER_DESK_RECEIVING_ORAL
								#ENDIF
							]]></slot>
						</character>
					</dominants>
					<submissives>
						<character>
							<id>pc</id>
							<slot><![CDATA[
								#IF(pc.getLegConfiguration()==LEG_CONFIGURATION_TAIL_LONG && pc.getGenitalArrangement()==GENITALS_CLOACA)
									OVER_DESK_OVER_DESK_ON_BACK
								#ELSE
									OVER_DESK_OVER_DESK_ON_FRONT
								#ENDIF
							]]></slot>
						</character>
					</submissives>
					<submissiveSpectators/>
					<postSexDialogue><![CDATA[innoxia_places_fields_elis_yui_dungeon_session_1_client_end_sex]]></postSexDialogue>
					<sexStartContent folderPath="txt/places/fields/elis/yui_dungeon">SESSION_1_SEX_START</sexStartContent>
					<ongoingActionsAtStart>
						<action>
							<condition><![CDATA[[#client.hasFetish(FETISH_IMPREGNATION)]]]></condition>
							<id><![CDATA[PenisVagina_PENIS_FUCKING_START]]></id>
							<performer><![CDATA[client]]></performer>
							<target><![CDATA[pc]]></target>
							<showDescription><![CDATA[false]]></showDescription>
							<showEffects><![CDATA[true]]></showEffects>
						</action>
						<action>
							<condition><![CDATA[[#!client.hasFetish(FETISH_IMPREGNATION)]]]></condition>
							<id><![CDATA[PenisMouth_BLOWJOB_START]]></id>
							<performer><![CDATA[client]]></performer>
							<target><![CDATA[pc]]></target>
							<showDescription><![CDATA[false]]></showDescription>
							<showEffects><![CDATA[true]]></showEffects>
						</action>
					</ongoingActionsAtStart>
				</sexVariablesWithManager>
			</response>
		</responses>
	</scene>
	
	<scene id="session_1_client_end_sex">
		<preParsingEffects><![CDATA[
			[#yui.initPostClientSex()]
			[#game.appendToTextStartStringBuilder(game.parseFromFile('txt/places/fields/elis/yui_dungeon', 'CLIENT_1_END_SEX'))]
			[#game.banishNPC(client)]
		]]></preParsingEffects>
        <title><![CDATA[Finished]]></title>
        <tooltip><![CDATA[Your [client.name] has had enough...]]></tooltip>
		<content/>
		<secondsPassed minutes="true"><![CDATA[10]]></secondsPassed>
		<continuesDialogue>false</continuesDialogue>
		<travelDisabled>true</travelDisabled>
		<responses>
			<!-- Night ended: -->
			<response>
				<availabilityConditional><![CDATA[[#game.isHourBetween(5, 12)]]]></availabilityConditional>
				<responseTabIndex><![CDATA[0]]></responseTabIndex>
				<index><![CDATA[1]]></index>
				<responseTitle><![CDATA[Yui arrives]]></responseTitle>
				<responseTooltip><![CDATA[You've serviced all of Yui's clients, and so the [yui.race] arrives to release you...]]></responseTooltip>
				<nextDialogue><![CDATA[innoxia_places_fields_elis_yui_dungeon_session_1_night_of_sex]]></nextDialogue>
			</response>
			<!-- More sex scenes: -->
			<response>
				<availabilityConditional><![CDATA[[#game.isHourBetween(12, 5)]]]></availabilityConditional>
				<responseTabIndex><![CDATA[0]]></responseTabIndex>
				<index><![CDATA[1]]></index>
				<responseTitle><![CDATA[Recover]]></responseTitle>
				<responseTooltip><![CDATA[
					You have a few moments in which to recover before another client arrives...
					<br/>[style.italicsSex(Keep on experiencing sex scenes as you're repeatedly fucked by Yui's clients.)]
				]]></responseTooltip>
				<nextDialogue><![CDATA[innoxia_places_fields_elis_yui_dungeon_session_1_client]]></nextDialogue>
			</response>
			<!-- Skip scenes: -->
			<response>
				<availabilityConditional><![CDATA[[#game.isHourBetween(12, 5)]]]></availabilityConditional>
				<responseTabIndex><![CDATA[0]]></responseTabIndex>
				<index><![CDATA[2]]></index>
				<responseTitle><![CDATA[Night of sex]]></responseTitle>
				<responseTooltip><![CDATA[
					You've got no other option but to spend the rest of the night in Yui's dungeon...
					<br/>[style.italicsMinorBad(This will skip through the rest of the night until Yui arrives to release you.)]
				]]></responseTooltip>
				<nextDialogue><![CDATA[innoxia_places_fields_elis_yui_dungeon_session_1_night_of_sex]]></nextDialogue>
			</response>
		</responses>
	</scene>
	
	<scene id="session_1_night_of_sex">
		<preParsingEffects><![CDATA[
			#IF(game.isHourBetween(12, 5))
				[#game.endTurn(~~game.getMinutesUntilTimeInMinutes(5 * 60) * 60)]
			#ENDIF
			[#yui.applyNightOfSex(pc, 1)]
			[#yui.setLocation(pc)]
		]]></preParsingEffects>
		<content folderPath="txt/places/fields/elis/yui_dungeon">SESSION_1_NIGHT_OF_SEX</content>
		<secondsPassed minutes="true"><![CDATA[
			5
		]]></secondsPassed>
		<continuesDialogue>false</continuesDialogue>
		<travelDisabled>true</travelDisabled>
		<responses>
			<response>
				<responseTabIndex><![CDATA[0]]></responseTabIndex>
				<index><![CDATA[1]]></index>
				<responseTitle><![CDATA[Released]]></responseTitle>
				<responseTooltip><![CDATA[Yui has returned to release you...]]></responseTooltip>
				<nextDialogue><![CDATA[innoxia_places_fields_elis_yui_dungeon_session_1_end]]></nextDialogue>
			</response>
		</responses>
	</scene>
	
	<scene id="session_1_end">
		<preParsingEffects/>
		<content folderPath="txt/places/fields/elis/yui_dungeon">SESSION_1_END</content>
		<secondsPassed minutes="true"><![CDATA[10]]></secondsPassed>
		<continuesDialogue>true</continuesDialogue>
		<travelDisabled>true</travelDisabled>
		<responses>
			<response>
				<responseTabIndex><![CDATA[0]]></responseTabIndex>
				<index><![CDATA[1]]></index>
				<responseTitle><![CDATA[Leave (shower)]]></responseTitle>
				<responseTooltip><![CDATA[Take a quick shower and then thank Mistress Yui for the good time and exit her dungeon.]]></responseTooltip>
				<nextDialogue><![CDATA[innoxia_places_fields_elis_yui_dungeon_session_1_end_final]]></nextDialogue>
				<secondsPassed minutes="true"><![CDATA[10]]></secondsPassed>
				<effects><![CDATA[
					[#pc.applyWash(true, false, SE_CLEANED_SHOWER, 250)]
					[#yui.restoreInventory(pc)]
					[#yui.setLocation(WORLD_TYPE_EMPTY, PLACE_TYPE_GENERIC_HOLDING_CELL)]
					[#pc.setLocation(WORLD_TYPE_innoxia_fields_elis_town, PLACE_TYPE_innoxia_fields_elis_town_tower_yui)]
					[#flags.setFlag(FLAG_innoxia_yui_dungeon_refused, true)]
					[#flags.setFlag(FLAG_innoxia_yui_dungeon_completed_stage_1, true)]
					[#game.appendToTextStartStringBuilder(game.parseFromFile('txt/places/fields/elis/yui_dungeon', 'SESSION_1_END_LEAVE_SHOWER'))]
					[#game.appendToTextStartStringBuilder(game.parseFromFile('txt/places/fields/elis/yui_dungeon', 'SESSION_1_END_LEAVE_FINAL'))]
				]]></effects>
			</response>
			<response>
				<responseTabIndex><![CDATA[0]]></responseTabIndex>
				<index><![CDATA[2]]></index>
				<responseTitle><![CDATA[Leave (no shower)]]></responseTitle>
				<responseTooltip><![CDATA[Thank Mistress Yui for the good time and exit her dungeon without having a shower.]]></responseTooltip>
				<nextDialogue><![CDATA[innoxia_places_fields_elis_yui_dungeon_session_1_end_final]]></nextDialogue>
				<secondsPassed minutes="true"><![CDATA[5]]></secondsPassed>
				<effects><![CDATA[
					[#yui.restoreInventory(pc)]
					[#yui.setLocation(WORLD_TYPE_EMPTY, PLACE_TYPE_GENERIC_HOLDING_CELL)]
					[#pc.setLocation(WORLD_TYPE_innoxia_fields_elis_town, PLACE_TYPE_innoxia_fields_elis_town_tower_yui)]
					[#flags.setFlag(FLAG_innoxia_yui_dungeon_refused, true)]
					[#flags.setFlag(FLAG_innoxia_yui_dungeon_completed_stage_1, true)]
					[#game.appendToTextStartStringBuilder(game.parseFromFile('txt/places/fields/elis/yui_dungeon', 'SESSION_1_END_LEAVE'))]
					[#game.appendToTextStartStringBuilder(game.parseFromFile('txt/places/fields/elis/yui_dungeon', 'SESSION_1_END_LEAVE_FINAL'))]
				]]></effects>
			</response>
		</responses>
	</scene>
	
	<scene id="session_1_end_final">
		<content/>
		<secondsPassed minutes="true"><![CDATA[5]]></secondsPassed>
		<continuesDialogue>true</continuesDialogue>
		<travelDisabled>true</travelDisabled>
		<responses>
			<response>
				<responseTabIndex><![CDATA[0]]></responseTabIndex>
				<index><![CDATA[1]]></index>
				<responseTitle><![CDATA[Continue]]></responseTitle>
				<responseTooltip><![CDATA[Continue on your way...]]></responseTooltip>
				<nextDialogue defaultPlaceType="innoxia_fields_elis_town_tower_yui"/>
				<secondsPassed minutes="true"><![CDATA[2]]></secondsPassed>
			</response>
		</responses>
	</scene>
</dialogueNodes>
